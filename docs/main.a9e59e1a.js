!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=6)}([function(e,n,t){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e,n){return s(e)||function(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return t}(e,n)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(e){if(Array.isArray(e))return e}t.r(n);var c=t(5),f=/^\.\/(.*?)\.(vert|frag).glsl$/;var u=document.createElement("canvas");document.body.appendChild(u);var l,d,A=u.getContext("webgl2"),v=function(e){return c.keys().reduce(function(n,t){var u=a(function(e,n){var t,u=a(e.match(f),3),l=u[1],d=u[2],A=s(t=l.split("-"))||o(t)||i(),v=A[0],b=A.slice(1),R=[v].concat(r(b.map(function(e){return e[0].toUpperCase()+e.substr(1)}))).join(""),p={vert:n.VERTEX_SHADER,frag:n.FRAGMENT_SHADER}[d];if(null==p)throw new Error("Unknown shader type ".concat(shaderType));var F=function(e,n,t,r){var o=r.createShader(t);if(r.shaderSource(o,n),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var a=r.getShaderInfoLog(o);console.error("Shader ".concat(e," compilation error:\n").concat(a))}return o}(e,c(e),p,n);return[d,R,F]}(t,e),3),l=u[0],d=u[1],A=u[2];return n[l][d]=A,n},{vert:{},frag:{}})}(A);function b(){A.canvas.width=l=innerWidth,A.canvas.height=d=innerHeight,A.viewport(0,0,l,d)}Object.assign(document.body.style,{margin:"0",padding:"0",overflow:"hidden"}),Object.assign(u.style,{position:"absolute",width:"100%",height:"100%"}),window.addEventListener("resize",b,!1),b();for(var R=1e5,p=new Float32Array(6*R),F=0;F<R;F++){var m=6*F,y=.1*Math.random(),g=Math.random()*Math.PI*2,h=.04*y,E=g+Math.PI/2+.1*(2*Math.random()-1)*Math.PI*2,x=Math.cos(g)*y,B=Math.sin(g)*y,_=Math.cos(E)*h,P=Math.sin(E)*h;p[m+0]=x,p[m+1]=B,p[m+2]=0,p[m+3]=_,p[m+4]=P,p[m+5]=0}function T(e,n){var t=A.createProgram();return e&&A.attachShader(t,e),n&&A.attachShader(t,n),t}function O(e){A.linkProgram(e),A.getProgramParameter(e,A.LINK_STATUS)||console.error("Error linking shaders:\n"+A.getProgramInfoLog(e))}var w=T(v.vert.integrate,v.frag.bypass);A.transformFeedbackVaryings(w,["outPos","outVel"],A.INTERLEAVED_ATTRIBS),O(w);var S=T(v.vert.offsetInstanced,v.frag.drawInstance);O(S);var U=A.createBuffer(),I=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,U),A.bufferData(A.ARRAY_BUFFER,p,A.DYNAMIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,p,A.DYNAMIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null);var V=new Float32Array([-1,-1,0,-1,1,0,1,-1,0,1,1,0]),L=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,L),A.bufferData(A.ARRAY_BUFFER,V,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null);var D=A.createTransformFeedback(),M=!1;function C(e,n){M||function(e,n){A.useProgram(w);var t=A.getAttribLocation(w,"pos"),r=A.getAttribLocation(w,"vel");A.enableVertexAttribArray(t),A.enableVertexAttribArray(r),A.bindBuffer(A.ARRAY_BUFFER,e),A.vertexAttribPointer(t,3,A.FLOAT,!1,24,0),A.vertexAttribPointer(r,3,A.FLOAT,!1,24,12),A.vertexAttribDivisor(t,0),A.vertexAttribDivisor(r,0),A.bindBuffer(A.ARRAY_BUFFER,null),A.bindTransformFeedback(A.TRANSFORM_FEEDBACK,D),A.bindBufferBase(A.TRANSFORM_FEEDBACK_BUFFER,0,n),A.beginTransformFeedback(A.POINTS),A.drawArrays(A.POINTS,0,R),A.endTransformFeedback(),A.bindBufferBase(A.TRANSFORM_FEEDBACK_BUFFER,0,null),A.disableVertexAttribArray(t),A.disableVertexAttribArray(r)}(e,n),function(e){A.useProgram(S);var n=A.getAttribLocation(S,"vertexPos"),t=A.getAttribLocation(S,"instanceOffset"),r=A.getAttribLocation(S,"instanceVelocity"),o=A.getUniformLocation(S,"resolution");A.enableVertexAttribArray(n),A.enableVertexAttribArray(t),A.enableVertexAttribArray(r),A.bindBuffer(A.ARRAY_BUFFER,e),A.vertexAttribPointer(t,3,A.FLOAT,!1,24,0),A.vertexAttribPointer(r,3,A.FLOAT,!1,24,12),A.vertexAttribDivisor(t,1),A.vertexAttribDivisor(r,1),A.bindBuffer(A.ARRAY_BUFFER,null),A.bindBuffer(A.ARRAY_BUFFER,L),A.vertexAttribPointer(n,3,A.FLOAT,!1,0,0),A.bindBuffer(A.ARRAY_BUFFER,null),A.clearColor(0,0,0,1),A.clear(A.COLOR_BUFFER_BIT),A.uniform2f(o,l,d),A.blendFunc(A.SRC_ALPHA,A.ONE),A.enable(A.BLEND),A.drawArraysInstanced(A.TRIANGLE_STRIP,0,4,R),A.disableVertexAttribArray(n),A.disableVertexAttribArray(t),A.disableVertexAttribArray(r)}(n)}var Y=U,N=I;requestAnimationFrame(function e(){C(Y,N),N=Y=N,requestAnimationFrame(e)}),document.addEventListener("keypress",function(e){switch(e.key){case" ":return void(M=!M)}})},function(e,n){e.exports="#version 300 es\n\nprecision mediump float;\n\nuniform vec2 resolution;\n\nin vec3 vertexPos;\nin vec3 instanceOffset;\nin vec3 instanceVelocity;\n\nflat out int instance;\nout vec2 texPos;\n\nvoid main () {\n    float ratio = resolution.x / resolution.y;\n\n    instance = gl_InstanceID;\n    texPos = vertexPos.xy;\n    vec3 pos = vertexPos;\n    pos.y *= ratio;\n    pos *= 0.01;\n    vec3 offset = instanceOffset;\n\n    float vel = sqrt(dot(instanceVelocity, instanceVelocity));\n    pos *= 0.5 + (1.0 - vel) * 0.1;\n    offset.y *= ratio;\n    vec3 finalVal = pos + offset;\n\n    gl_Position = vec4(finalVal, 1.0);\n}\n"},function(e,n){e.exports="#version 300 es\n\nprecision highp float;\n\nin vec3 pos;\nin vec3 vel;\n\nout vec3 outPos;\nout vec3 outVel;\n\nvoid main () {\n    // vec3 acc = vec3(0.0, -0.0001, 0.0);\n    float d2 = dot(pos, pos);\n    float d = sqrt(d2);\n    // float force = min(0.001, 0.0000001 / d2);\n\n    vec3 acc = -(pos / d) / max(0.001,d2);\n\n    outVel = vel + acc * 0.000001;\n    outPos = pos + outVel;\n    // outVel = vel;\n    // outPos = pos;\n}\n"},function(e,n){e.exports="#version 300 es\n\nprecision mediump float;\n\nout vec4 outColor;\n\nflat in int instance;\nin vec2 texPos;\n\nvoid main () {\n    float i = float(instance) * 0.1;\n    float d = 1.0 - min(dot(texPos, texPos), 1.0);\n    float dd = d * d * d * d;\n    outColor = vec4(0.3, mod(i, 1.0), 1.0, dd);\n}\n"},function(e,n){e.exports="#version 300 es\n\nprecision mediump float;\n\nout vec4 outColor;\n\nvoid main () {\n    outColor = vec4(0.5, 0.0, 1.0, 1.0);\n}\n"},function(e,n,t){var r={"./bypass.frag.glsl":4,"./draw-instance.frag.glsl":3,"./integrate.vert.glsl":2,"./offset-instanced.vert.glsl":1};function o(e){var n=a(e);return t(n)}function a(e){var n=r[e];if(!(n+1)){var t=new Error('Cannot find module "'+e+'".');throw t.code="MODULE_NOT_FOUND",t}return n}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=5},function(e,n,t){e.exports=t(0)}]);